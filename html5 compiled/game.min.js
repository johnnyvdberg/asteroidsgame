var menuMusic=Boolean(get("menuMusic",!0)),menuAnimate=Boolean(get("menuAnimate",!0)),fullscreen=Boolean(get("fullscreen",!0)),graphicsQuality=Number(get("graphicsQuality",2)),difficulty=Number(get("difficulty",1)),menuSound=Number(get("menuSound",0)),musicVolume=Number(get("musicVolume",50)),effectsVolume=Number(get("effectsVolume",50)),highscoreDummy,highscoreArray=[],gamePlaying=!1,timer=null,mousePos=null,soundManager,currentMusicIndex=-1,currentPlaylist=[],playMusic=!0,musicType,timeattack=!1,
mouseDown,mouseDownAble=!0,demWidth=window.innerWidth,demHeight=window.innerHeight,now,delta,soundNames=[{id:"menu0",url:"music/menu/01-Vangelis-Heaven-and-Hell.ogg"},{id:"menu1",url:"music/menu/206-vangelis-dream_in_an_open_place.ogg"},{id:"game0",url:"music/game/hypnosis-oxygene-cut.ogg"},{id:"game1",url:"music/game/koto-from_the_dawn_of_time-cut.ogg"},{id:"click0",url:"sounds/menu/clicksound0.ogg"},{id:"hover0",url:"sounds/menu/hoversound0.ogg"},{id:"click1",url:"sounds/menu/clicksound1.ogg"},
{id:"hover1",url:"sounds/menu/hoversound1.ogg"},{id:"click2",url:"sounds/menu/clicksound2.ogg"},{id:"hover2",url:"sounds/menu/hoversound2.ogg"},{id:"click3",url:"sounds/menu/clicksound3.ogg"},{id:"hover3",url:"sounds/menu/hoversound3.ogg"},{id:"click4",url:"sounds/menu/clicksound4.ogg"},{id:"hover4",url:"sounds/menu/hoversound4.ogg"},{id:"explosion",url:"sounds/game/explosion.ogg"},{id:"assexplosion",url:"sounds/game/assexplosion.mp3"},{id:"intoslomo",url:"sounds/game/intoslomo.ogg"},{id:"outofslomo",
url:"sounds/game/outofslomo.ogg"},{id:"alert",url:"sounds/game/alert.mp3"},{id:"taunt_win_0",url:"sounds/game/taunt_corecrusher.ogg"},{id:"taunt_win_1",url:"sounds/game/taunt_hastalaplanet.ogg"},{id:"taunt_win_2",url:"sounds/game/taunt_muwhahaha.ogg"},{id:"taunt_win_3",url:"sounds/game/taunt_planetcrushed.ogg"},{id:"taunt_win_4",url:"sounds/game/taunt_thatwasmoonploding.ogg"},{id:"taunt_hurt_0",url:"sounds/game/taunt_help.ogg"},{id:"taunt_fail_0",url:"sounds/game/taunt_missionfailed.ogg"}],soundNamesCompatibility=
[{id:"menu0",url:"music/menu/01-Vangelis-Heaven-and-Hell.mp3"},{id:"menu1",url:"music/menu/206-vangelis-dream_in_an_open_place.mp3"},{id:"game0",url:"music/game/hypnosis-oxygene-cut.mp3"},{id:"game1",url:"music/game/koto-from_the_dawn_of_time-cut.mp3"},{id:"click0",url:"sounds/menu/clicksound0.mp3"},{id:"hover0",url:"sounds/menu/hoversound0.mp3"},{id:"click1",url:"sounds/menu/clicksound1.mp3"},{id:"hover1",url:"sounds/menu/hoversound1.mp3"},{id:"click2",url:"sounds/menu/clicksound2.mp3"},{id:"hover2",
url:"sounds/menu/hoversound2.mp3"},{id:"click3",url:"sounds/menu/clicksound3.mp3"},{id:"hover3",url:"sounds/menu/hoversound3.mp3"},{id:"click4",url:"sounds/menu/clicksound4.mp3"},{id:"hover4",url:"sounds/menu/hoversound4.mp3"},{id:"explosion",url:"sounds/game/explosion.mp3"},{id:"assexplosion",url:"sounds/game/assexplosion.mp3"},{id:"intoslomo",url:"sounds/game/intoslomo.mp3"},{id:"outofslomo",url:"sounds/game/outofslomo.mp3"},{id:"alert",url:"sounds/game/alert.mp3"},{id:"taunt_win_0",url:"sounds/game/taunt_corecrusher.mp3"},
{id:"taunt_win_1",url:"sounds/game/taunt_hastalaplanet.mp3"},{id:"taunt_win_2",url:"sounds/game/taunt_muwhahaha.mp3"},{id:"taunt_win_3",url:"sounds/game/taunt_planetcrushed.mp3"},{id:"taunt_win_4",url:"sounds/game/taunt_thatwasmoonploding.mp3"},{id:"taunt_hurt_0",url:"sounds/game/taunt_help.mp3"},{id:"taunt_fail_0",url:"sounds/game/taunt_missionfailed.mp3"}],planetNames=[{name:"Ariel"},{name:"Beaumonde"},{name:"Bellerophon"},{name:"Hera"},{name:"Jiangyin"},{name:"Miranda"},{name:"Osiris"},{name:"Persephone"},
{name:"Regina"},{name:"Santo"},{name:"St. Albans"},{name:"Triumph"},{name:"Aberdeen"},{name:"Angel"},{name:"Athens"},{name:"Bernadette"},{name:"Beylix"},{name:"Boros"},{name:"Constance"},{name:"Deadwood"},{name:"Ezra"},{name:"Greenleaf"},{name:"Harvest"},{name:"Highgate"},{name:"Kerry"},{name:"Liann Jiun"},{name:"Londinium"},{name:"Muir"},{name:"Newhall"},{name:"New Melbourne"},{name:"Pelorum"},{name:"Salisbury"},{name:"Shadow"},{name:"Sihnon"},{name:"Three Hills"},{name:"Verbena"},{name:"Whittier"},
{name:"Druidia"},{name:"Planet Spaceballs"},{name:"Times New Roman"},{name:"Comic Sans"},{name:"Vulcan"},{name:"Omicron"},{name:"Kronos"},{name:"Bergia"},{name:"Titan"},{name:"Canceros"},{name:"Olympus"},{name:"New Vegas"},{name:"Liteon"},{name:"Olsen"},{name:"Hannibal"},{name:"Nigerium"},{name:"Eurydome"},{name:"Carme"},{name:"Natrium"}],planetProperties=[{name:"Barren",popMultiplier:0.3,speedMultiplier:40},{name:"Sulfuric",popMultiplier:0,speedMultiplier:45},{name:"Glacial",popMultiplier:0.5,speedMultiplier:45},
{name:"Barren",popMultiplier:0,speedMultiplier:45},{name:"Sulfuric",popMultiplier:0,speedMultiplier:45},{name:"Molten",popMultiplier:0,speedMultiplier:50},{name:"Barren",popMultiplier:0.4,speedMultiplier:55},{name:"Terrestrial",popMultiplier:5E8,speedMultiplier:70},{name:"Terrestrial",popMultiplier:75E7,speedMultiplier:75},{name:"Terrestrial",popMultiplier:1E9,speedMultiplier:80},{name:"Glacial",popMultiplier:0.2,speedMultiplier:80},{name:"Gas Giant",popMultiplier:0,speedMultiplier:100},{name:"Gas Giant",
popMultiplier:0,speedMultiplier:100}];function canvasHide(){showLoader();canvas.style.display="none"}function canvasShow(){hideLoader();canvas.style.display=""}function hideLoader(){document.getElementsByTagName("body")[0].style.backgroundImage=""}function showLoader(){document.getElementsByTagName("body")[0].style.backgroundImage="images/menu/loader.gif"}function getMousePos(a,c){var b=a.getBoundingClientRect();return{x:c.clientX-b.left,y:c.clientY-b.top}}function l(a){console.log(a)}
function supportsLocalStorage(){return"localStorage"in window&&null!==window.localStorage}function set(a,c){!1==c&&(c="");if(supportsLocalStorage())localStorage["asshole.asstroids."+a]=c.toString();else return null}function get(a,c){return supportsLocalStorage()?null!=localStorage&&void 0!=localStorage["asshole.asstroids."+a]?localStorage["asshole.asstroids."+a].toString():c.toString():c.toString()}function stopTimer(){null!=timer&&(window.clearInterval(timer),timer=null)}
function cmp(a,c,b,d){return mousePos.y>=a&&mousePos.y<=c&&mousePos.x>=b&&mousePos.x<=d?!0:!1}function barpos(a){return 290-2.13*a}function drawImageRotated(a,c,b,d,e,f){ctx.save();ctx.translate(c+d/2,b+e/2);ctx.rotate(f);ctx.translate(-(d/2),-(e/2));ctx.drawImage(a,0,0);ctx.restore()}function drawScaled(a,c,b,d,e,f){ctx.save();ctx.translate(c+d/2,b+e/2);ctx.scale(f,f);ctx.translate(-(d/2),-(e/2));ctx.drawImage(a,0,0);ctx.restore()}
function notification(a,c,b,d,e,f){sizeX=b;sizeY=d;ctx.beginPath();ctx.lineWidth=1;ctx.strokeStyle="green";ctx.rect(a,c,sizeX,sizeY);ctx.fillStyle="rgba(0, 255, 0, 0.15)";ctx.fill();ctx.stroke();ctx.closePath();for(i=0;i<sizeY/7;i++)ctx.beginPath(),ctx.strokeStyle="rgba(0, 255, 0, 0.04)",ctx.moveTo(a,c+7*i),ctx.lineTo(a+sizeX,c+7*i),ctx.stroke(),ctx.closePath();ctx.font="bold 12pt Arial Black";ctx.fillStyle="Green";ctx.fillText(e,a+10,c+5);ctx.font="bold italic 10pt Arial Black";ctx.fillText(f,a+
10,c+25)}function romanize(a){if(3999999<a)return alert("Number is too big!"),!1;var c="",b="M CM D CD C XC L XL X IX V IV I".split(" "),d=[1E3,900,500,400,100,90,50,40,10,9,5,4,1];3999999>=a&&4E3<=a&&(c='<label style="text-decoration: overline;">'+convert(a.substr(0,a.length-3))+"</label>",a=a.substr(a.length-3));for(x=0;x<b.length;x++)for(;a>=d[x];)c+=b[x],a-=d[x];return c}function switchScreen(a,c){stopTimer();menuPlayClick();c&&canvasHide();a()}
function backgroundPanning(){pan.xMode?(pan.x-=0.05*delta,-pan.x>4096-demWidth&&(pan.xMode=!1)):(pan.x+=0.1*delta,0<pan.x&&(pan.xMode=!0));pan.yMode?(pan.y-=0.1*delta,-pan.y>4096-demHeight&&(pan.yMode=!1)):(pan.y+=0.05*delta,0<pan.y&&(pan.yMode=!0))}$(window).resize(function(){demWidth=window.innerWidth;demHeight=window.innerHeight;canvas.width=demWidth;canvas.height=demHeight;canvasxc=demWidth/2;canvasyc=demHeight/2});function getDelta(){now=Date.now();delta=now-then;then=now}
function InitPlaylist(a){stopMusic();currentMusicIndex=-1;musicType=a;var c=!1,b=0;for(a=1==a?"menu":"game";!c;)null!=soundManager.getSoundById(a+b)?(currentPlaylist[b]=soundManager.getSoundById(a+b),b++):c=!0;checkPlayMusic()}function playNextItem(){currentMusicIndex++;currentMusicIndex>=currentPlaylist.length&&(currentMusicIndex=0);playItem()}function playItem(){playVolume();currentPlaylist[currentMusicIndex].play({onfinish:function(){playNextItem()}})}
function playVolume(){void 0!=currentPlaylist[currentMusicIndex]&&currentPlaylist[currentMusicIndex].setVolume(musicVolume)}function stopMusic(){void 0!=currentPlaylist[currentMusicIndex]&&1==currentPlaylist[currentMusicIndex].playState&&currentPlaylist[currentMusicIndex].stop()}function checkPlayMusic(){(playMusic=1==musicType?menuMusic:gameMusic)?playNextItem():stopMusic()}
function getInternetExplorerVersion(){var a=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(a=parseFloat(RegExp.$1));return a}var realLen=0;
function loadSounds(){var a=new PxLoader,c,b,d,e;e=0;var f=-1<getInternetExplorerVersion()?soundNamesCompatibility:soundNames;c=0;for(b=f.length;c<b;c++)d=f[c].url,soundManager.canPlayURL(d)&&("hover"==f[c].id.substring(0,5)?(a.addSound(f[c].id+"_1",d),a.addSound(f[c].id+"_2",d),a.addSound(f[c].id+"_3",d),a.addSound(f[c].id+"_4",d),realLen+=4):(a.addSound(f[c].id,d),realLen++));b=f.length;a.addProgressListener(function(a){e++;e>=realLen&&menuLoad()});a.start()}var SoundmanagerTries=0;
function Init(){canvas=document.createElement("canvas");canvas.width=demWidth;canvas.height=demHeight;canvas.style.display="none";ctx=canvas.getContext("2d");document.body.appendChild(canvas);canvas.addEventListener("mousemove",function(a){mousePos=getMousePos(canvas,a)},!1);canvas.addEventListener("mousedown",function(a){mouseDownAble&&(mouseDown=!0)},!1);canvas.addEventListener("mouseup",function(a){mouseDownAble=!0;mouseDown=!1},!1);soundManager.url="soundmanager2/";soundManager.flashVersion=9;
soundManager.useHighPerformance=!0;soundManager.flashLoadTimeout=500;soundManager.audioFormats.mp3.required=!1;soundManager.onready(function(){loadSounds()});soundManager.ontimeout(function(){l("Failed to load flash, going for html5 only");soundManager.useHTML5Audio=!0;soundManager.preferFlash=!1;soundManager.reboot()});highscoreDummy=get("highscore","null");"null"!=highscoreDummy&&$.each(JSON.parse(highscoreDummy),function(a,c){highscoreArray.push({name:c.name,score:c.score,mode:c.mode,difficulty:c.difficulty})})}
window.onload=function(a){Init()};var pan={xMode:!0,yMode:!0,x:0,y:0},hoverIndicator={showing:0,cy:0,ty:0};function menuPlayClick(){1==soundManager.getSoundById("click"+menuSound).playState&&soundManager.getSoundById("click"+menuSound).stop();soundManager.getSoundById("click"+menuSound).setVolume(parseInt(effectsVolume));soundManager.play("click"+menuSound,{onfinish:function(){}})}
function menuPlayHoverSound(a){1==soundManager.getSoundById("hover"+menuSound+"_"+a).playState?4>a&&menuPlayHoverSound(a+1):(soundManager.getSoundById("hover"+menuSound+"_"+a).setVolume(parseInt(effectsVolume)),soundManager.play("hover"+menuSound+"_"+a,{onfinish:function(){}}))}function menuMove(a){hoverIndicator.cy=hoverIndicator.cy+a<hoverIndicator.ty?hoverIndicator.cy+a:hoverIndicator.cy-a>hoverIndicator.ty?hoverIndicator.cy-a:hoverIndicator.ty}
function menuHover(a,c){var b=hoverIndicator.ty;0<hoverIndicator.showing?hoverIndicator.ty=a:(hoverIndicator.cy=a,hoverIndicator.ty=a,b=-1);hoverIndicator.showing+=3*c;500<hoverIndicator.showing&&(hoverIndicator.showing=500);a!=b&&menuPlayHoverSound(1)}function menuHoverOut(a){hoverIndicator.showing-=3*a;0>hoverIndicator.showing&&(hoverIndicator.showing=0)}
function menuLoad(){var a=new PxLoader;menuBgImg=a.addImage("images/menu/bg.png");menuBg2Img=a.addImage("images/menu/bg2.png");menuTitleImg=a.addImage("images/menu/title.png");menuArcadeImg=a.addImage("images/menu/arcade.png");menuTimeattackImg=a.addImage("images/menu/timeattack.png");menuHighscoresImg=a.addImage("images/menu/highscores.png");menuOptionsImg=a.addImage("images/menu/options.png");menuQuitImg=a.addImage("images/menu/quit.png");a.addCompletionListener(function(){menuLoaded()});a.start()}
function menuLoaded(){then=Date.now();menuUpdate();timer=setInterval("menuUpdate();",1);InitPlaylist(1);canvasShow()}
function menuUpdate(){getDelta();void 0!=mousePos&&(cmp(demHeight-300,demHeight-260,demWidth-235,demWidth)?(menuHover(demHeight-300,delta),mouseDown&&mouseDownAble&&(timeattack=mouseDownAble=!1,switchScreen(insLoad,!0))):cmp(demHeight-260,demHeight-220,demWidth-235,demWidth)?(menuHover(demHeight-260,delta),mouseDown&&mouseDownAble&&(mouseDownAble=!1,timeattack=!0,switchScreen(insLoad,!0))):cmp(demHeight-220,demHeight-180,demWidth-235,demWidth)?(menuHover(demHeight-220,delta),mouseDown&&mouseDownAble&&
(mouseDownAble=!1,switchScreen(highscoreLoad,!1))):cmp(demHeight-140,demHeight-100,demWidth-235,demWidth)?(menuHover(demHeight-140,delta),mouseDown&&mouseDownAble&&(mouseDownAble=!1,switchScreen(optionLoad,!1))):cmp(demHeight-100,demHeight-60,demWidth-235,demWidth)?(menuHover(demHeight-100,delta),mouseDown&&mouseDownAble&&(mouseDownAble=!1,window.close())):menuHoverOut(delta),menuMove(delta));menuAnimate&&backgroundPanning();ctx.drawImage(menuBgImg,0+pan.x,0+pan.y);ctx.drawImage(menuTitleImg,20,20);
ctx.drawImage(menuArcadeImg,demWidth-140,demHeight-300);ctx.drawImage(menuTimeattackImg,demWidth-225,demHeight-260);ctx.drawImage(menuHighscoresImg,demWidth-220,demHeight-220);ctx.drawImage(menuOptionsImg,demWidth-155,demHeight-140);ctx.drawImage(menuQuitImg,demWidth-92,demHeight-100);ctx.beginPath();ctx.rect(demWidth-235,hoverIndicator.cy,234,35);ctx.fillStyle="rgba(255,255,255,"+hoverIndicator.showing/1E3+")";ctx.fill()}
var canvas,ctx,gameMusic=!0,junkhit=0,score=0,outscore="0",gear=0,powerup=0,poweruptime=0,bullettimesound=!1,planetCount=0,tauntPlaying=!1,round=0,timeleft=120,notifyActive=!1,notifyMainTitle="Undefined",notifySubTitle="Really, there's nothing here",ass={speed:0,x:0,y:0,angle:0,w:80,h:80,lives:2,exploding:-1,alive:!0},planetImages=[],planet={x:0,y:0,size:0,calcsize:0,w:120,h:120,alive:!0,exploding:-1,angle:0,calcangle:0,distance:0,type:0,visible:!1,pop:0,requiredSpeed:0,name:"Undefined",indicator:!1,
indicatorside:!0},scoreobj={amount:"",time:-1},asstroid={ox:0,oy:0,x:0,y:0,size:0,spawntimer:5,alive:!1,explosion:-1,xoffset:0},planets=[],orbit={xtiles:0,ytiles:0,angle:0,distance:50,bullettime:!1,bullettimepercentage:0,bullettimeup:!0,planetinview:!1,planetlastcheck:0,speed:1,velocity:100},planetsDestroyed=0,canvasxc,canvasyc,fps=0,fpscounter=0,fpscount=0,then,keysDown={},detailedParticles=!0,radarAngle=0,ox,oy,particles=[],particle_count=1E3,loader,assImage,planetImage,starImage,bgImage,parImage,
explode1Image,explode2Image,bgTiles,assFrames,smallExplodeImage,warningImage,deathImage,warpZ=25,units=10,stars=[],cycle=0,Z=0.095,Rnd=Math.random,Sin=Math.sin,Floor=Math.floor;
function gameLoad(){var a=new PxLoader;bgTiles=[];for(var c=0;6>c;c++)bgTiles[c]=a.addImage("images/game/space_"+c+".png");assFrames=a.addImage("images/game/ass_sprite.png");starImage=a.addImage("images/game/star.png");bgImage=a.addImage("images/game/bg.jpg");parImage=a.addImage("images/game/1.png");parIceImage=a.addImage("images/game/ice.png");explodeImage1=a.addImage("images/game/explode.png");explodeImage2=a.addImage("images/game/ring.png");explodeRingIceImage=a.addImage("images/game/ring_ice.png");
explodeRingFireImage=a.addImage("images/game/ring_fire.png");glowImage=a.addImage("images/game/glow.png");smallExplodeImage=a.addImage("images/game/smallring.png");warningImage=a.addImage("images/game/warning.png");deathImage=a.addImage("images/game/death.png");asteroidMiniImage=a.addImage("images/game/asteroid.png");radarbgImage=a.addImage("images/game/radarbg.png");radarlineImage=a.addImage("images/game/radarline.png");powerupImage=a.addImage("images/game/powerup.png");speedImage=a.addImage("images/game/speed.png");
livesImage=a.addImage("images/game/lives.png");lifeImage=a.addImage("images/game/life.png");statsImage=a.addImage("images/game/stats.png");orbitImage=a.addImage("images/game/orbit.png");fireImage=a.addImage("images/game/powerups/fire.png");iceImage=a.addImage("images/game/powerups/ice.png");scoreImage=a.addImage("images/game/powerups/score.png");nostopImage=a.addImage("images/game/powerups/nostop.png");planetImages.push(a.addImage("images/game/planets/Arid_World.png"));planetImages.push(a.addImage("images/game/planets/Caldonia.png"));
planetImages.push(a.addImage("images/game/planets/Cold_World.png"));planetImages.push(a.addImage("images/game/planets/Dead_World.png"));planetImages.push(a.addImage("images/game/planets/Drye.png"));planetImages.push(a.addImage("images/game/planets/Pyrobora.png"));planetImages.push(a.addImage("images/game/planets/Waterless_World.png"));planetImages.push(a.addImage("images/game/planets/Global_Warming.png"));planetImages.push(a.addImage("images/game/planets/Mostly_Harmless.png"));planetImages.push(a.addImage("images/game/planets/Nu_Earth.png"));
planetImages.push(a.addImage("images/game/planets/Ice_Planet.png"));planetImages.push(a.addImage("images/game/planets/Small_Gas_Giant.png"));planetImages.push(a.addImage("images/game/planets/High_Winds.png"));a.addCompletionListener(function(){gameStart()});a.start()}
var gameStart=function(){canvasxc=canvas.width/2;canvasyc=canvas.height/2;orbit.xtiles=Math.ceil(canvas.width/512)+1;orbit.ytiles=Math.ceil(canvas.height/512)+1;ass.lives=3;score=junkhit=0;outscore="0";timeleft=120;addEventListener("keydown",function(a){keysDown[a.keyCode]=!0},!1);addEventListener("keyup",function(a){delete keysDown[a.keyCode]},!1);gameBegin();timer=setInterval(gameMain,1)},gameResume=function(){timer=setInterval(gameMain,1)};
function gameBegin(){ass.x=canvas.width/2;ass.y=canvas.height/2;ass.angle=0;ass.speed=600;ass.exploding=-1;ass.alive=!0;orbit.angle=0;orbit.distance=50;orbit.bullettimepercentage=0;orbit.bullettime=!1;orbit.bullettimeup=!0;orbit.velocity=100;resetEnemyAsstroid();for(var a=0,c;a<units;a++)c={},resetstar(c),stars.push(c);loadLevel1();then=Date.now();InitPlaylist(2);gameMain();canvasShow()}
function drawExplodingPlanet(a){var c=a.exploding,b=Math.round(c);0==powerup||2<powerup?(drawScaled(explodeImage2,a.x-250,a.y-250,500,500,c/3),ctx.drawImage(explodeImage1,0,240*b,240,240,a.x-120,a.y-120,240,240)):1==powerup?ctx.drawImage(explodeRingFireImage,0,240*b,240,240,a.x-120,a.y-120,240,240):2==powerup&&ctx.drawImage(explodeRingIceImage,0,240*b,240,240,a.x-120,a.y-120,240,240);checkPlanetEvent()}
function checkPlanetEvent(){for(i=planetCount=0;i<planets.length;i++)if(planets[i].alive){planetCount++;break}if(0==planetCount)soundManager.setVolume("taunt_win_2",Math.round(effectsVolume)),tauntPlaying=!0,soundManager.play("taunt_win_2",{onfinish:function(){tauntPlaying=!1}}),loadLevel1(),notifyActive=!0,notifyMainTitle="Solarsystem "+round,notifySubTitle="Nice going man";else if(!tauntPlaying){randomTaunt=Math.floor(4*Math.random());randomTauntSound="taunt_win_0";switch(randomTaunt){case 0:randomTauntSound=
"taunt_win_0";break;case 1:randomTauntSound="taunt_win_1";break;case 2:randomTauntSound="taunt_win_2";break;case 3:randomTauntSound="taunt_win_3"}notifyActive=!0;notifyMainTitle="Planet destroyed!";notifySubTitle="Cold blooded";soundManager.setVolume(randomTauntSound,Math.round(effectsVolume));tauntPlaying=!0;soundManager.play(randomTauntSound,{onfinish:function(){notifyActive=tauntPlaying=!1}})}}
function drawExplodingEnemyAsstroid(){drawScaled(smallExplodeImage,asstroid.x-137,asstroid.y-132,275,267,asstroid.explosion)}function drawExplodingAsstroid(){var a=ass.exploding;5>a&&drawScaled(smallExplodeImage,ass.x-137,ass.y-132,275,267,a/3);4<a&&10>a&&drawScaled(deathImage,ass.x-150,ass.y-250,300,500,(a-4)/3)}
function drawTiledBackground(a,c){for(var b=(a-a%512)/512,d=(c-c%512)/512,e=0,f,k,g=0;g<orbit.xtiles;g++)for(var h=0;h<orbit.ytiles;h++)f=512*g,k=512*h,e=(g+b)%3+3*((h+d)%2),ctx.drawImage(bgTiles[e],f-a%512,k-c%512)}function resetstar(a){a.x=(-20+40*Math.random())*warpZ;a.y=(-10+30*Math.random())*warpZ;a.z=2+2*Math.random();a.px=0;a.py=0}
function gameWarp(){var a=ass.x+60;cy=canvas.height/2;Floor(500*Z);for(var c=0;c<units;c++){var b=stars[c],d=b.x/b.z,e=b.y/b.z,f=2*(0.5/b.z+1),d=d-20*b.z;0!==b.px&&(1==powerup?(ctx.lineWidth=1.5*f,ctx.strokeStyle="rgb(200,0,0)"):(ctx.lineWidth=f,ctx.strokeStyle="rgb(200,200,200)"),ctx.beginPath(),ctx.moveTo(d+a,e+cy),ctx.lineTo(d+a,e+cy+3),ctx.stroke());b.px=d;b.py=e;b.z=0<orbit.bullettimepercentage?b.z-Z*1*orbit.speed:b.z-1.2*Z;(b.z<Z||b.px>canvas.width/2||b.py>canvas.height/2)&&resetstar(b)}cycle+=
0.01}
function minimapRender(a){planetCollision=-1;for(var c=0;c<planets.length;c++)null!=planets[c]&&planets[c].alive&&(miniplanetx=planets[c].distance/1.5*-Math.cos(6.28318531*((1-planets[c].angle)/100))+83,miniplanety=planets[c].distance/1.5*Math.sin(6.28318531*((1-planets[c].angle)/100))+(canvas.height-84),ctx.beginPath(),ctx.strokeStyle="#00ff00",angleDiff=getAngleDifference(orbit.angle,planets[c].angle),ctx.lineWidth=0>angleDiff&&-10<angleDiff?3+3*Math.sin(3.14159265359*(Math.abs(angleDiff)/10)):
3,ctx.arc(miniplanetx,miniplanety,1,0,6.28318531,!1),ctx.stroke(),ctx.closePath(),0.8>Math.abs(orbit.distance-planets[c].distance)&&(planetCollision=c));0<orbit.distance&&(miniassx=orbit.distance/1.5*-Math.cos(6.28318531*((100-orbit.angle)/100))+78,miniassy=orbit.distance/1.5*Math.sin(6.28318531*((100-orbit.angle)/100))+canvas.height-89,ctx.beginPath(),ctx.lineWidth=1,ctx.arc(83,canvas.height-84,orbit.distance/1.5,0,6.28318531,!1),ctx.strokeStyle=-1==planetCollision?"white":"red",ctx.stroke(),ctx.closePath());
c=new Date;2>a?(radarx=75*Math.cos(c.getTime()/1E3)+83,radary=75*Math.sin(c.getTime()/1E3)+canvas.height-84,ctx.beginPath(),ctx.strokeStyle="rgba(0, 255, 0, 0.3)",ctx.lineWidth=1,ctx.moveTo(83,canvas.height-84),ctx.lineTo(radarx,radary),ctx.closePath(),ctx.stroke()):(1<=radarAngle&&(radarAngle=0),radarAngle+=0.005,drawImageRotated(radarlineImage,7,demHeight-159,150,150,6.28318531*((orbit.angle+75)%100/100)));ctx.drawImage(asteroidMiniImage,miniassx,miniassy,10,10)}
function gameDrawPlanet(a){a=planets[a];a.alive&&(drawScaled(planetImages[a.type],a.x-60,a.y-60,planet.w,planet.h,a.calcsize),1>a.calcsize&&gameDrawAsstroid())}
function planetIndicator(a,c,b,d,e,f,k){var g=a.x,h=a.y-150;0>g&&(g=0);g>canvas.width&&(g=canvas.width);f=a.indicatorside?g>canvasxc+200?!1:!0:g<canvasxc-200?!0:!1;a.indicatorside=f;a=0;f||(a=-225);ctx.strokeStyle="green";ctx.lineWidth=1;ctx.beginPath();ctx.moveTo(g,h+75);ctx.lineTo(g,h+75+20);ctx.closePath();ctx.stroke();ctx.beginPath();ctx.rect(g+a,h,225,75);ctx.fillStyle="rgba(0, 255, 0, 0.15)";ctx.fill();ctx.closePath();ctx.stroke();for(i=0;2==k&&i<75/7;i++)ctx.beginPath(),ctx.strokeStyle="rgba(0, 255, 0, 0.04)",
ctx.moveTo(g+a,h+7*i),ctx.lineTo(g+225+a,h+7*i),ctx.stroke(),ctx.closePath();ctx.font="bold 8pt Arial Black";ctx.fillStyle="Green";ctx.fillText("Name",g+10+a,h+8);ctx.fillText("Type",g+10+a,h+24);ctx.fillText("Pop",g+10+a,h+40);ctx.fillText("Speed",g+10+a,h+56);ctx.fillText(e,g+100+a,h+8);ctx.fillText(c,g+100+a,h+24);ctx.fillText(b,g+100+a,h+40);ctx.strokeStyle=97<d?"GreenYellow":"green";ctx.beginPath();ctx.strokeWidth=1;ctx.rect(g+100+a,h+60,115*(d/100),8);ctx.fill();ctx.stroke();ctx.closePath()}
function gameDrawAsstroid(){var a=Math.floor(ass.angle);ass.alive?ctx.drawImage(assFrames,0,80*a,80,80,ass.x-40,ass.y-40,80,80):drawExplodingAsstroid()}function gameDrawEnemyAsstroid(){asstroid.alive?ctx.drawImage(assFrames,0,80*Math.floor(10*asstroid.size),80,80,asstroid.x-40,asstroid.y-40,80*asstroid.size,80*asstroid.size):-1<asstroid.explosion&&drawExplodingEnemyAsstroid()}function gameDead(){ass.exploding=0;gamePlayDeath();ass.alive=!1}
function gameDeadEnd(){ass.lives--; -1<ass.lives?gameBegin():gameOver()}function gameOver(){l("gameover");gamePlayFail();highscoreSubmitPopup(score,1);switchScreen(highscoreLoad,!0)}
function scoreAdd(a,c,b){var d=score;typeBonus=0;typeBonus=7>c?1E4:10>c?2E4:5E4;tempScore=(a/1E7+typeBonus)*b;tempScore=Math.floor(tempScore*(0.95+0.1*Math.random()));score=1==powerup?score+1.5*tempScore:4==powerup||2==powerup?score+2*tempScore:score+tempScore;scoreobj.amount="+"+numberWithCommas(score-d);scoreobj.size=(score-d)/5E5;scoreobj.time=2;outscore=numberWithCommas(score)}
function resetEnemyAsstroid(){asstroid.ox=Math.random()*1.2*canvasxc+canvasxc/2;asstroid.oy=Math.random()*1.5*canvasyc+canvasyc/2;asstroid.xoffset=300*Math.random()-150}
var gameMain=function(){var a=Date.now(),c=(a-then)/1E3;gameUpdate(c);gameRender(c);then=a;fpscounter+=c;fpscount++;1<fpscounter&&(fpscounter-=1,fps=fpscount,fpscount=0)},gameUpdate=function(a){speedmodifier=a*(orbit.velocity/100);37 in keysDown?(ass.x-=1.5*ass.speed*speedmodifier,0>ass.x-50&&(ass.x=0)):39 in keysDown?(ass.x+=ass.speed*speedmodifier,ass.x+50>canvas.width&&(ass.x=canvas.width-50)):27 in keysDown?(gamePlaying=!0,menuPlayClick(),switchScreen(optionLoad,!1)):73 in keysDown?(powerup=2,
poweruptime=9):70 in keysDown&&(powerup=1,poweruptime=9);orbit.bullettime||(orbit.distance+=(ass.x-canvasxc)/100*speedmodifier,0>orbit.distance&&(orbit.distance=0,ass.alive&&gameDead()),100<orbit.distance&&ass.alive&&gameDead(),ass.x<canvasxc&&(ass.x+=35*a,ass.x>canvasxc&&(ass.x=canvasxc)),ass.x>canvasxc&&(ass.x-=35*a,ass.x<canvasxc&&(ass.x=canvasxc)));!1==ass.alive&&(ass.exploding+=15*a,10<ass.exploding&&gameDeadEnd());if(0<asstroid.spawntimer&&!asstroid.alive)-1<asstroid.explosion&&(asstroid.explosion+=
5*a,1.5<asstroid.explosion&&(asstroid.explosion=-1)),orbit.bullettime||(asstroid.spawntimer-=a),0>asstroid.spawntimer&&(asstroid.spawntimer=8*Math.random()+4,asstroid.alive=!0,asstroid.size=0);else if(asstroid.size+=3*speedmodifier,2<asstroid.size?(asstroid.alive=!1,resetEnemyAsstroid()):(asstroid.x=asstroid.ox+(canvasxc-asstroid.ox)*asstroid.size+asstroid.xoffset,asstroid.y=asstroid.oy+(canvasyc-asstroid.oy)*asstroid.size),1<asstroid.size&&1.3>asstroid.size&&asstroid.x<ass.x+60&&asstroid.x>ass.x-
60){asstroid.alive=!1;asstroid.explosion=0;gamePlayAsstroidExplosion();junkhit++;if(3!=powerup||1!=powerup)2==powerup?0==difficulty?orbit.velocity-=20*(orbit.velocity/100)/2+15:1==difficulty?orbit.velocity-=25*(orbit.velocity/100)/2+20:2==difficulty&&(orbit.velocity-=30*(orbit.velocity/100)/2+25):0==difficulty?orbit.velocity-=20*(orbit.velocity/100)+15:1==difficulty?orbit.velocity-=25*(orbit.velocity/100)+20:2==difficulty&&(orbit.velocity-=30*(orbit.velocity/100)+25);resetEnemyAsstroid()}if(0<orbit.planetlastcheck){orbit.planetlastcheck=
0;orbit.planetinview=!1;orbit.bullettimeup=!1;for(var c=0;c<planets.length;c++){var b=planets[c];if(b.alive&&b.distance<orbit.distance+4&&b.distance>orbit.distance-4){var d=b.distance-orbit.distance;btdist=-5.8*(orbit.velocity/100);b.x=canvasxc+300*d;b.indicator=!0;b.alive&&checkAngleDifference(b.angle,orbit.angle,btdist,0.5)&&b.distance<orbit.distance+1.2&&b.distance>orbit.distance-1.2?(b.visible=!0,orbit.planetinview=!0,orbit.bullettime=!0,orbit.bullettimeup=!0):b.visible=!1}else b.indicator=!1,
b.visible=!1}}else orbit.planetlastcheck+=a;if(orbit.planetinview||orbit.bullettime)for(c=0;c<planets.length;c++)if(b=planets[c],b.calcangle=getAngleDifference(b.angle,orbit.angle),0.1>b.calcangle?(b.calcsize=2*b.calcangle+1,0>b.calcsize&&(b.calcsize=0)):b.calcsize=2*b.calcangle+1,0.01>b.calcangle&&-0.01<b.calcangle&&b.visible&&ass.x-30<=b.x+60*b.calcsize&&ass.x+30>=b.x-60*b.calcsize){var d=(b.x-ass.x)/50,e=(b.y+b.h/2-(ass.y+ass.h/2))/30;planetsDestroyed++;0==difficulty&&(timeleft+=30);1==difficulty&&
(timeleft+=20);2==difficulty&&(timeleft+=10);if(b.alive){if(3!=powerup||1!=powerup)orbit.velocity=2==powerup?orbit.velocity-b.requiredSpeed/2:orbit.velocity-b.requiredSpeed;b.alive=!1;b.exploding=0;scoreAdd(b.pop,b.type,ass.speed);for(c=0;c<particle_count;c++)particles.push(new particle(b.x,b.y,d,e));gamePlayExplosion();switch(b.type){case 2:case 10:powerup=2;poweruptime=19;break;case 5:powerup=1;poweruptime=19;break;case 7:case 8:case 9:powerup=4;poweruptime=19;break;case 11:case 12:powerup=3,poweruptime=
19}}}5>orbit.velocity&&ass.alive&&gameDead();!1==orbit.bullettime?(ass.angle+=25*speedmodifier,orbit.angle-=15*speedmodifier,orbit.speed=1):(orbit.bullettimeup?(bullettimesound||(bullettimesound=!0,slowMotionSound(!0)),orbit.bullettimepercentage+=1.5*a,1<orbit.bullettimepercentage&&(orbit.bullettimepercentage=1)):(orbit.bullettimepercentage-=1.5*speedmodifier,0>=orbit.bullettimepercentage&&(orbit.bullettimepercentage=0,bullettimesound=orbit.bullettime=!1,slowMotionSound(!1))),orbit.speed=1-0.97*orbit.bullettimepercentage,
0<orbit.bullettimepercentage&&(orbit.angle-=15*speedmodifier*orbit.speed,ass.angle+=25*speedmodifier*orbit.speed));60<=ass.angle&&(ass.angle-=60);0>orbit.angle&&(orbit.angle+=100)},gameRender=function(a){speeddelta=a*(orbit.velocity/100);ctx.textBaseline="top";-1<planet.exploding?(ox=-10+20*Math.random(),oy=-10+20*Math.random()):oy=ox=0;!1==orbit.bullettime?(ox=-2+4*Math.random(),oy=-2+4*Math.random()):oy=ox=0;drawTiledBackground(Math.round(30.72*orbit.angle),0);gameWarp();glowx=-(2.5*orbit.distance);
ctx.drawImage(glowImage,glowx,0,glowImage.width/2,canvas.height);1>asstroid.spawntimer&&0<asstroid.spawntimer&&(ctx.drawImage(warningImage,asstroid.ox-100+asstroid.xoffset,asstroid.oy-50,200,100),alertSound());1>asstroid.size&&gameDrawEnemyAsstroid();gameDrawAsstroid();if(orbit.planetinview||orbit.bullettime)for(var c=0;c<planets.length;c++){var b=planets[c];b.visible&&gameDrawPlanet(c);!1==b.alive&&-1<b.exploding&&5>b.exploding?(b.exploding+=15*a,drawExplodingPlanet(b)):b.exploding=-1}else gameDrawAsstroid();
1<=asstroid.size&&gameDrawEnemyAsstroid();for(c=0;c<planets.length;c++)b=planets[c],speedPercentage=100*((orbit.velocity-30)/b.requiredSpeed),100<speedPercentage?speedPercentage=100:0>speedPercentage&&(speedPercentage=0),b.indicator&&planetIndicator(b,planetProperties[b.type].name,b.pop,speedPercentage,b.name,!1,2);for(var d=!1,c=0;c<particles.length;c++)if(b=particles[c],null!=b&&(d=!0,b.opacity=b.remaining_life/b.life,2==powerup?ctx.drawImage(parIceImage,b.location.x,b.location.y):ctx.drawImage(parImage,
b.location.x,b.location.y),b.remaining_life-=70*a,b.radius+=10*a,b.location.x+=b.speed.x*220*a,b.location.y+=b.speed.y*220*a,0>b.remaining_life||400<b.radius))particles[c]=null;!0!=d&&0<particles.length&&(particles=[]);orbit.bullettime||(orbit.velocity+=5*((100-orbit.distance)/100)*a,timeleft-=a,0>timeleft&&gameDead(),0!=powerup&&(poweruptime-=a),0>poweruptime&&(powerup=0));ctx.drawImage(radarbgImage,6,demHeight-160);ctx.drawImage(speedImage,130,demHeight-160);ctx.drawImage(powerupImage,168,demHeight-
118);ctx.drawImage(livesImage,290,demHeight-160);ctx.drawImage(statsImage,290,demHeight-118);ctx.drawImage(orbitImage,290,demHeight-33);0<ass.lives&&ctx.drawImage(lifeImage,295,demHeight-160);1<ass.lives&&ctx.drawImage(lifeImage,323,demHeight-160);2<ass.lives&&ctx.drawImage(lifeImage,351,demHeight-160);3<ass.lives&&ctx.drawImage(lifeImage,379,demHeight-160);4<ass.lives&&ctx.drawImage(lifeImage,407,demHeight-160);ctx.beginPath();ctx.strokeWidth=1;ctx.fillStyle=50>orbit.velocity?"rgba(180, 0, 0, 0.5)":
"rgba(6, 64, 2, 0.5)";gear=Math.floor(orbit.velocity/100);ctx.rect(277,demHeight-157,-(1.08*orbit.velocity)+108*gear,27);ctx.fill();ctx.closePath();ctx.beginPath();ctx.strokeWidth=1;ctx.fillStyle=10>orbit.distance||90<orbit.distance?"rgba(180, 0, 0, 0.5)":"rgba(6, 64, 2, 0.5)";ctx.rect(293,demHeight-30,1.45*orbit.distance,19);ctx.fill();ctx.closePath();1==powerup&&ctx.drawImage(fireImage,173,demHeight-113);2==powerup&&ctx.drawImage(iceImage,173,demHeight-113);3==powerup&&ctx.drawImage(nostopImage,
173,demHeight-113);4==powerup&&ctx.drawImage(scoreImage,173,demHeight-113);ctx.font="12px Rock";minimapRender(2);ctx.fillStyle="rgb(20, 105, 5)";ctx.fillText("POWERUP",173,demHeight-127);ctx.fillText("SPEED",143,demHeight-170);ctx.fillText("LIVES",303,demHeight-169);ctx.fillText("STATS",303,demHeight-127);ctx.fillText("ORBIT",303,demHeight-43);ctx.font="14px Rock";ctx.fillText(gear,152,demHeight-160);ctx.fillText(Math.round(poweruptime),263,demHeight-20);0!=powerup&&(poweruptime-=1*a);0>poweruptime&&
(powerup=0);ctx.fillText("SCORE: "+outscore,295,demHeight-110);ctx.fillText("PLANETS HIT: "+planetsDestroyed,295,demHeight-95);ctx.fillText("JUNK HIT: "+junkhit,295,demHeight-80);timeattack&&ctx.fillText("TIME LEFT: "+Math.floor(timeleft),295,demHeight-65);-1<scoreobj.time&&(scoreobj.time-=a,0>scoreobj.time&&(scoreobj.time=-1),ctx.font=Math.round(scoreobj.size)+"px Rock",ctx.textAlign="center",ctx.fillText(scoreobj.amount,canvasxc,20),ctx.textAlign="left");notifyActive&&notification(demWidth-270,
20,250,50,notifyMainTitle,notifySubTitle)};
function drawDebugText(){ctx.fillStyle="rgb(250, 250, 250)";ctx.font="24px Arial";ctx.textAlign="left";ctx.textBaseline="top";ctx.fillText("Planets annihilated: "+planetsDestroyed,32,32);ctx.fillText("FPS: "+fps,32,64);ctx.fillText("Angle: "+Math.round(orbit.angle)+" AssAngle :"+Math.round(ass.angle),32,140);ctx.fillText("bullatp: "+Math.round(100*orbit.bullettimepercentage),32,170);ctx.fillText("Velocity: "+Math.round(orbit.velocity),32,200);ctx.fillText("Lives: "+ass.lives,32,230);ctx.fillText("Planet x: "+
Math.round(planet.x)+" Planet y: "+Math.round(planet.y),32,260);ctx.fillText("Planet in view: "+orbit.planetinview,32,290);orbit.bullettime&&ctx.fillText("FUCKING BULLETTIME",36-8*Math.random(),100-8*Math.random())}function debugLine(a,c,b,d,e){ctx.beginPath();ctx.moveTo(a,c);ctx.lineTo(b,d);ctx.strokeStyle=e;ctx.lineWidth=1;ctx.stroke()}function numberWithCommas(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}
function particle(a,c,b,d){d=2*Math.random()*Math.PI;var e=Math.random()+0.2;b+=5*Math.cos(d)*e;d=5*Math.sin(d)*e;this.speed={x:b,y:d};this.location={x:a,y:c};this.radius=1+20*Math.random();this.remaining_life=this.life=10+20*Math.random();this.r=Math.round(105*Math.random()+145);this.g=Math.round(25*Math.random()+this.r/4);this.b=Math.round(25*Math.random())}
function gamePlayExplosion(){1==soundManager.getSoundById("explosion").playState&&soundManager.getSoundById("explosion").stop();soundManager.setVolume("explosion",Math.round(0.3*effectsVolume));soundManager.play("explosion",{onfinish:function(){}})}
function gamePlayDeath(){1==soundManager.getSoundById("taunt_win_2").playState&&soundManager.getSoundById("taunt_win_2").stop();soundManager.setVolume("taunt_win_2",Math.round(0.3*effectsVolume));soundManager.play("taunt_win_2",{onfinish:function(){}})}
function gamePlayFail(){1==soundManager.getSoundById("taunt_fail_0").playState&&soundManager.getSoundById("taunt_fail_0").stop();soundManager.setVolume("taunt_fail_0",Math.round(0.3*effectsVolume));soundManager.play("taunt_fail_0",{onfinish:function(){}})}
function gamePlayAsstroidExplosion(){1==soundManager.getSoundById("assexplosion").playState&&soundManager.getSoundById("assexplosion").stop();soundManager.setVolume("assexplosion",Math.round(0.3*effectsVolume));soundManager.play("assexplosion",{onfinish:function(){}})}function checkAngleDifference(a,c,b,d){a=getAngleDifference(a,c);if(a>=b&&a<=d)return!0}function getAngleDifference(a,c){var b=a-c;50<b&&(b-=100);-50>b&&(b+=100);return b}
function slowMotionSound(a){a&&0==soundManager.getSoundById("intoslomo").playState?(soundManager.setVolume("intoslomo",Math.round(0.5*effectsVolume)),soundManager.play("intoslomo",{onfinish:function(){}})):0==soundManager.getSoundById("outofslomo").playState&&(soundManager.setVolume("outofslomo",Math.round(0.5*effectsVolume)),soundManager.play("outofslomo",{onfinish:function(){}}))}
function alertSound(){0==soundManager.getSoundById("alert").playState&&(soundManager.setVolume("alert",Math.round(0.3*effectsVolume)),soundManager.play("alert",{onfinish:function(){}}))}function loadLevel1(){randomGas=2+Math.floor(2*Math.random())+round;randomNormal=3+Math.floor(2*Math.random())+round;randomOther=2+Math.floor(2*Math.random())+round;randomLevel(randomGas,randomNormal,randomOther);round++}
function randomLevel(a,c,b){planets=[];planet.alive=!0;planet.size=1;planet.h=120;planet.w=120;planet.y=canvasyc;planet.x=canvasxc;difficultyModifier=1;switch(difficulty){case 0:difficultyModifier=2;break;case 1:difficultyModifier=1.5;break;case 2:difficultyModifier=1;break;default:difficultyModifier=0.5}for(i=0;i<b;i++)planet.size=0.5,planet.angle=100*Math.random(),planet.distance=20*Math.random()+20,planet.type=Math.floor(7*Math.random()),planet.name=planetNames[Math.floor(Math.random()*planetNames.length)].name+
" "+romanize(Math.floor(11*Math.random())),planet.pop=Math.floor(10*Math.random()*planetProperties[planet.type].popMultiplier),planet.requiredSpeed=Math.floor(planetProperties[planet.type].speedMultiplier*(0.8+0.4*Math.random())/difficultyModifier*(1+round/10)),planets.push($.extend(!0,{},planet));for(i=0;i<c;i++)planet.size=1,planet.angle=100*Math.random(),planet.distance=25*Math.random()+35,planet.type=Math.floor(4*Math.random()+7),planet.name=planetNames[Math.floor(Math.random()*planetNames.length)].name+
" "+romanize(Math.floor(11*Math.random())),planet.pop=Math.floor(10*Math.random()*planetProperties[planet.type].popMultiplier),planet.requiredSpeed=Math.floor(planetProperties[planet.type].speedMultiplier*(0.8+0.4*Math.random())/difficultyModifier*(1+round/10)),planets.push($.extend(!0,{},planet));for(i=0;i<a;i++)planet.size=3,planet.angle=100*Math.random(),planet.distance=25*Math.random()+70,planet.type=Math.floor(3*Math.random()+10),planet.name=planetNames[Math.floor(Math.random()*planetNames.length)].name+
" "+romanize(Math.floor(11*Math.random())),planet.pop=0,planet.requiredSpeed=Math.floor(planetProperties[planet.type].speedMultiplier*(0.9+0.2*Math.random())/difficultyModifier*(1+round/10)),planets.push($.extend(!0,{},planet));for(i=0;i<planets.length;i++)for(x=0;x<planets.length;x++)x!=i&&(angleDiff=getAngleDifference(planets[i].angle,planets[x].angle),distDiff=Math.abs(planets[i].distance-planets[x].distance),7.5>distDiff&&5>Math.abs(angleDiff)&&randomLevel(a,c,b))}
function highscoreLoad(){var a=new PxLoader;menuBgImg=a.addImage("images/menu/bg.png");menuTitleImg=a.addImage("images/menu/title.png");menuQuitImg=a.addImage("images/menu/quit.png");a.addCompletionListener(function(){highscoreLoaded()});a.start()}function highscoreLoaded(){then=Date.now();highscoreUpdate();timer=setInterval("highscoreUpdate();",1);canvasShow()}function highscorePlayClick(){soundManager.setVolume("click",100);soundManager.play("click",{onfinish:function(){}})}
function highscorePlayHoverSound(a){1==soundManager.getSoundById("hover"+a).playState?4>a&&highscorePlayHoverSound(a+1):(soundManager.setVolume("hover"+a,90),soundManager.play("hover"+a,{onfinish:function(){}}))}function highscoreSubmitPopup(a,c){var b=prompt("Please enter your name","");null!=b&&highscoreSubmitScore(b,a,c)}function highscoreSubmitScore(a,c,b){highscoreArray.push({name:a,score:c,mode:b,difficulty:difficulty});set("highscore",JSON.stringify(highscoreArray))}
var popupElementsDrawn=!0;
function highscoreUpdate(){getDelta();void 0!=mousePos&&(cmp(demHeight-100,demHeight-60,demWidth-235,demWidth)?(menuHover(demHeight-100,delta),mouseDown&&mouseDownAble&&(menuPlayClick(),mouseDownAble=!1,switchScreen(menuLoad,!1),popupElementsDrawn&&(popupElementsDrawn=showHighscorePopup=!1,$("#txtName").remove(),$("#btnSubmitScore").remove(),$("#divScorePopup").remove()))):menuHoverOut(delta),menuMove(delta));menuAnimate&&backgroundPanning();ctx.drawImage(menuBgImg,0+pan.x,0+pan.y);ctx.drawImage(menuTitleImg,
20,20);ctx.drawImage(menuQuitImg,demWidth-92,demHeight-100);var a=canvas.width/2-200;ctx.font="24pt SpaceOne";ctx.fillStyle="White";ctx.fillText("Name",a-100,180);ctx.fillText("Score",a+200,180);ctx.font="20pt SpaceOne";var c=highscoreArray.sort(function(a,b){var c=parseFloat(a.score),k=parseFloat(b.score);return c>k?-1:c<k?1:0});for(i=0;i<c.length&&10>i;i++)for(ctx.beginPath(),ctx.strokeStyle="rgba(255, 255, 255, 0.4)",ctx.moveTo(a-100,203+28*(i+1)),ctx.lineTo(a+400,203+28*(i+1)),ctx.stroke(),ctx.closePath(),
ctx.fillText(c[i].name,a-100,200+28*(i+1)),12<c[i].score.length&&(c[i].score="999999999999"),ii=0;12>ii;ii++)if(12-c[i].score.length<=ii){var b=0;"1"==c[i].score[ii-(12-c[i].score.length)]&&(b=5);ctx.fillText(c[i].score[ii-(12-c[i].score.length)],a+200+16*ii+b,200+28*(i+1))}else ctx.fillText("0",a+200+16*ii,200+28*(i+1));ctx.beginPath();ctx.rect(demWidth-235,hoverIndicator.cy,234,35);ctx.fillStyle="rgba(255,255,255,"+hoverIndicator.showing/1E3+")";ctx.fill()}
function optionLoad(){var a=new PxLoader;menuBgImg=a.addImage("images/menu/bg.png");menuTitleImg=a.addImage("images/menu/title.png");menuQuitImg=a.addImage("images/menu/quit.png");menuResumeImg=a.addImage("images/menu/resume.png");menuAnimateImg=a.addImage("images/menu/menuAnimate.png");menuMusicImg=a.addImage("images/menu/menuMusic.png");fullscreenImg=a.addImage("images/menu/fullscreen.png");graphicsImg=a.addImage("images/menu/graphics.png");difficultyImg=a.addImage("images/menu/difficulty.png");
musicVolumeImg=a.addImage("images/menu/musicVolume.png");effectsVolumeImg=a.addImage("images/menu/effectsVolume.png");menuSoundImg=a.addImage("images/menu/menuSound.png");lowImg=a.addImage("images/menu/low.png");mediumImg=a.addImage("images/menu/medium.png");highImg=a.addImage("images/menu/high.png");easyImg=a.addImage("images/menu/easy.png");normalImg=a.addImage("images/menu/normal.png");hardImg=a.addImage("images/menu/hard.png");daveyImg=a.addImage("images/menu/davey.png");hrvojeImg=a.addImage("images/menu/hrvoje.png");
johnnyImg=a.addImage("images/menu/johnny.png");martijnImg=a.addImage("images/menu/martijn.png");barImg=a.addImage("images/menu/bar.png");lineImg=a.addImage("images/menu/line.png");arrowLeftImg=a.addImage("images/menu/arrowLeft.png");arrowRightImg=a.addImage("images/menu/arrowRight.png");menuCheckboxImg=a.addImage("images/menu/checkbox.png");menuCheckedImg=a.addImage("images/menu/checked.png");a.addCompletionListener(function(){optionLoaded()});a.start()}
function optionLoaded(){then=Date.now();optionUpdate();timer=setInterval("optionUpdate();",1);canvasShow()}var SliderMouseIsDown=!1;
function optionUpdate(){getDelta();void 0!=mousePos&&(cmp(demHeight-100,demHeight-60,demWidth-235,demWidth)?(menuHover(demHeight-100,delta),mouseDown&&mouseDownAble&&(menuPlayClick(),mouseDownAble=gamePlaying=!1,switchScreen(menuLoad,!1))):cmp(demHeight-140,demHeight-100,demWidth-235,demWidth)&&!0==gamePlaying?(menuHover(demHeight-140,delta),mouseDown&&mouseDownAble&&(menuPlayClick(),mouseDownAble=!1,switchScreen(gameResume,!1))):cmp(demHeight/2-195,demHeight/2-169,demWidth/2-100,demWidth/2-74)?mouseDown&&
mouseDownAble&&(menuPlayClick(),mouseDownAble=!1,menuMusic=!menuMusic,set("menuMusic",menuMusic),checkPlayMusic()):cmp(demHeight/2-155,demHeight/2-129,demWidth/2-100,demWidth/2-74)?mouseDown&&mouseDownAble&&(menuPlayClick(),mouseDownAble=!1,menuAnimate=!menuAnimate,set("menuAnimate",menuAnimate)):cmp(demHeight/2-115,demHeight/2-79,demWidth/2-100,demWidth/2-74)?mouseDown&&mouseDownAble&&(menuPlayClick(),mouseDownAble=!1,fullscreen=!fullscreen,set("fullscreen",fullscreen)):cmp(demHeight/2-30,demHeight/
2+5,demWidth/2-100,demWidth/2-66)?mouseDown&&mouseDownAble&&(mouseDownAble=!1,2>graphicsQuality&&(menuPlayClick(),graphicsQuality++,set("graphicsQuality",graphicsQuality))):cmp(demHeight/2-30,demHeight/2+5,demWidth/2-290,demWidth/2-256)?mouseDown&&mouseDownAble&&(mouseDownAble=!1,0<graphicsQuality&&(menuPlayClick(),graphicsQuality--,set("graphicsQuality",graphicsQuality))):cmp(demHeight/2+10,demHeight/2+45,demWidth/2-100,demWidth/2-66)?mouseDown&&mouseDownAble&&(mouseDownAble=!1,2>difficulty&&(menuPlayClick(),
difficulty++,set("difficulty",difficulty))):cmp(demHeight/2+10,demHeight/2+45,demWidth/2-290,demWidth/2-256)?mouseDown&&mouseDownAble&&(mouseDownAble=!1,0<difficulty&&(menuPlayClick(),difficulty--,set("difficulty",difficulty))):cmp(demHeight/2+50,demHeight/2+85,demWidth/2-100,demWidth/2-66)?mouseDown&&mouseDownAble&&(mouseDownAble=!1,4>menuSound&&(menuSound++,set("menuSound",menuSound),menuPlayClick())):cmp(demHeight/2+50,demHeight/2+85,demWidth/2-290,demWidth/2-256)?mouseDown&&mouseDownAble&&(mouseDownAble=
!1,0<menuSound&&(menuSound--,set("menuSound",menuSound),menuPlayClick())):cmp(demHeight/2+140,demHeight/2+178,demWidth/2-300,demWidth/2-54)?mouseDown?(SliderMouseIsDown=!0,musicVolume=Math.round(0.4425*(mousePos.x-(demWidth/2-290))),100<musicVolume&&(musicVolume=100),0>musicVolume&&(musicVolume=0),set("musicVolume",musicVolume),playVolume()):SliderMouseIsDown&&(SliderMouseIsDown=!1,menuPlayClick()):cmp(demHeight/2+180,demHeight/2+218,demWidth/2-300,demWidth/2-54)?mouseDown?(SliderMouseIsDown=!0,effectsVolume=
Math.round(0.4425*(mousePos.x-(demWidth/2-290))),100<effectsVolume&&(effectsVolume=100),0>effectsVolume&&(effectsVolume=0),set("effectsVolume",effectsVolume),l("effectsvol: "+effectsVolume)):SliderMouseIsDown&&(SliderMouseIsDown=!1,menuPlayClick()):menuHoverOut(delta),menuMove(delta));menuAnimate&&backgroundPanning();ctx.drawImage(menuBgImg,0+pan.x,0+pan.y);ctx.drawImage(menuTitleImg,20,20);ctx.drawImage(menuQuitImg,demWidth-92,demHeight-100);gamePlaying&&ctx.drawImage(menuResumeImg,demWidth-165,
demHeight-140);menuMusic?ctx.drawImage(menuCheckedImg,demWidth/2-100,demHeight/2-195):ctx.drawImage(menuCheckboxImg,demWidth/2-100,demHeight/2-195);menuAnimate?ctx.drawImage(menuCheckedImg,demWidth/2-100,demHeight/2-155):ctx.drawImage(menuCheckboxImg,demWidth/2-100,demHeight/2-155);fullscreen?ctx.drawImage(menuCheckedImg,demWidth/2-100,demHeight/2-115):ctx.drawImage(menuCheckboxImg,demWidth/2-100,demHeight/2-115);ctx.drawImage(menuMusicImg,demWidth/2-50,demHeight/2-200);ctx.drawImage(menuAnimateImg,
demWidth/2-50,demHeight/2-160);ctx.drawImage(fullscreenImg,demWidth/2-50,demHeight/2-120);0==graphicsQuality&&(ctx.drawImage(lowImg,demWidth/2-220,demHeight/2-30),ctx.drawImage(arrowRightImg,demWidth/2-100,demHeight/2-30));1==graphicsQuality&&(ctx.drawImage(arrowLeftImg,demWidth/2-290,demHeight/2-30),ctx.drawImage(mediumImg,demWidth/2-250,demHeight/2-30),ctx.drawImage(arrowRightImg,demWidth/2-100,demHeight/2-30));2==graphicsQuality&&(ctx.drawImage(arrowLeftImg,demWidth/2-290,demHeight/2-30),ctx.drawImage(highImg,
demWidth/2-215,demHeight/2-30));ctx.drawImage(graphicsImg,demWidth/2-50,demHeight/2-30);0==difficulty&&(ctx.drawImage(easyImg,demWidth/2-220,demHeight/2+10),ctx.drawImage(arrowRightImg,demWidth/2-100,demHeight/2+10));1==difficulty&&(ctx.drawImage(arrowLeftImg,demWidth/2-290,demHeight/2+10),ctx.drawImage(normalImg,demWidth/2-245,demHeight/2+10),ctx.drawImage(arrowRightImg,demWidth/2-100,demHeight/2+10));2==difficulty&&(ctx.drawImage(arrowLeftImg,demWidth/2-290,demHeight/2+10),ctx.drawImage(hardImg,
demWidth/2-220,demHeight/2+10));ctx.drawImage(difficultyImg,demWidth/2-50,demHeight/2+10);0==menuSound&&(ctx.drawImage(normalImg,demWidth/2-245,demHeight/2+50),ctx.drawImage(arrowRightImg,demWidth/2-100,demHeight/2+50));1==menuSound&&(ctx.drawImage(arrowLeftImg,demWidth/2-290,demHeight/2+50),ctx.drawImage(daveyImg,demWidth/2-239,demHeight/2+50),ctx.drawImage(arrowRightImg,demWidth/2-100,demHeight/2+50));2==menuSound&&(ctx.drawImage(arrowLeftImg,demWidth/2-290,demHeight/2+50),ctx.drawImage(hrvojeImg,
demWidth/2-246,demHeight/2+50),ctx.drawImage(arrowRightImg,demWidth/2-100,demHeight/2+50));3==menuSound&&(ctx.drawImage(arrowLeftImg,demWidth/2-290,demHeight/2+50),ctx.drawImage(johnnyImg,demWidth/2-240,demHeight/2+50),ctx.drawImage(arrowRightImg,demWidth/2-100,demHeight/2+50));4==menuSound&&(ctx.drawImage(arrowLeftImg,demWidth/2-290,demHeight/2+50),ctx.drawImage(martijnImg,demWidth/2-240,demHeight/2+50));ctx.drawImage(menuSoundImg,demWidth/2-50,demHeight/2+50);ctx.drawImage(lineImg,demWidth/2-290,
demHeight/2+150);ctx.drawImage(barImg,demWidth/2-barpos(musicVolume),demHeight/2+140);ctx.drawImage(musicVolumeImg,demWidth/2-50,demHeight/2+140);ctx.drawImage(lineImg,demWidth/2-290,demHeight/2+190);ctx.drawImage(barImg,demWidth/2-barpos(effectsVolume),demHeight/2+180);ctx.drawImage(effectsVolumeImg,demWidth/2-50,demHeight/2+180);ctx.beginPath();ctx.rect(demWidth-235,hoverIndicator.cy,234,35);ctx.fillStyle="rgba(255,255,255,"+hoverIndicator.showing/1E3+")";ctx.fill()}
function insLoad(){var a=new PxLoader;instructionImage=a.addImage("images/menu/instructions.png");a.addCompletionListener(function(){insLoaded()});a.start()}function insLoaded(){hoverIndicator.showing=0;then=Date.now();insUpdate();timer=setInterval("insUpdate();",1);canvasShow()}
function insUpdate(){getDelta();var a=canvas.width/2-200,c=canvas.height/2-200;void 0!=mousePos&&(cmp(c+353,c+388,a+70,a+330)?(menuHover(c+353,delta),mouseDown&&mouseDownAble&&(mouseDownAble=!1,switchScreen(gameLoad,!0))):menuHoverOut(delta),menuMove(delta));ctx.fillStyle="#000000";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.drawImage(instructionImage,a,c);ctx.beginPath();ctx.rect(a+70,hoverIndicator.cy,260,35);ctx.fillStyle="rgba(255,255,255,"+hoverIndicator.showing/1E3+")";ctx.fill()};